graph TB
    subgraph CPP["C++ Core (Nitro HybridObject)"]
        HM["HybridPerfMonitor"]
        FPS1["FPSTracker - UI Thread"]
        FPS2["FPSTracker - JS Thread"]
        PM["PlatformMetrics"]
        HM --> FPS1
        HM --> FPS2
        HM --> PM
    end

    subgraph IOS["iOS Native"]
        CDL["CADisplayLink"]
        TI["task_info / Mach APIs"]
        CDL --> FPS1
        CDL --> FPS2
        TI --> PM
    end

    subgraph ANDROID["Android Native"]
        CH["Choreographer via JNI"]
        PROC["/proc/self/status"]
        CH --> FPS1
        PROC --> PM
    end

    subgraph JS["JavaScript"]
        RAF["requestAnimationFrame"]
        OBS["PerformanceObserver"]
        HEAP["Heap Polling"]
        PROF["React Profiler"]
        RAF --> FPS2
        OBS -->|"reportLongTask/reportSlowEvent"| HM
        HEAP -->|"reportJsHeap"| HM
        PROF -->|"reportRender"| HM
    end

    subgraph CONSUMERS["Consumers"]
        OV["PerfOverlay - On Device"]
        HOOK["usePerfMetrics - React Hook"]
        DT["Rozenite DevTools Panel"]
    end

    subgraph AI["AI Insights (DevTools)"]
        HEU["Heuristic Engine"]
        LLM["LLM Analysis"]
        CLAUDE["Claude API"]
        OPENAI["OpenAI API"]
        GEMINI["Gemini API"]
        LLM --> CLAUDE
        LLM --> OPENAI
        LLM --> GEMINI
    end

    HM --> OV
    HM --> HOOK
    HM -->|"CDP Bridge"| DT
    DT -->|"PerfSnapshot"| HEU
    DT -->|"PerfSnapshot + Component Stats"| LLM
